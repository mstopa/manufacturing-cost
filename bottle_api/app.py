from bottle import run, get, post, request

from failure_predictor.classifiers import SklearnClassifier

classifier = SklearnClassifier("model.joblib")

@get('/bottle_status')
def bottle():
    return {"healthy": True}

@post('/bottle_run')
def bottle():
    features = request.json["features"]
    result = int(classifier.predict(features))
    return {"result": result}

# {
#     "features": [
#     2.1989189144853802,2.1148792092386612,-0.10668463193927712,0.4270598579024361,0.9737224875438883,-1.5166297645476823,-1.415613261654083,2.000796121592504,1.9698118419066908,0.9821713673795671,1.5463420722034589,-0.32152772118567385,5.0307940785990505e-17,1.7343867841518682e-17,-1.65648919140735e-17,3.6943807313760474e-17,-2.8668735061138345e-18,0.0,-1.836922121912958e-17,-5.9376795979726406e-18,-1.644466080701788e-17,0.3549494854601531,-0.2873346734144398,1.795025048376297,-2.5524985648168945,-1.2475834262928176,0.0,0.6562302830106397,0.6728667652715492,1.000300210963649,-3.907146670006556,2.7976387557451354,-1.9564555769201882e-17,-1.3693223088113309e-17,3.357717107164789e-17,1.2296684620808835e-17,0.0,-1.22148558462394,1.791312786001609,-0.9011502669602867,-0.8038912705903847,-0.024813622772917755,0.052062359036689515,5.848337062224063e-17,3.8470060678553605e-17,6.185969306598973e-17,-3.4241997854719035e-17,-1.1432779261798513e-17,3.8089682408670105e-17,1.6028088524220226e-17,2.3386478221236047e-17,1.537107598254688e-17,0.0,-3.341582939991945e-17,-2.4537794376573417e-17,0.0,1.0203722105540994e-17,0.0,8.84743615157673e-19,0.0,-2.742047945186612e-18,0.0,0.0,1.5536601273048076e-17,1.433910710833105e-17,7.335084926223804e-18,-7.132935480532499e-18,2.304035420349226e-17,-5.788392034304427e-18,0.0,2.4355191750859668e-18,-4.465123315493062e-18,-1.8940753637365774e-18,0.0,1.6306372727533692e-18,2.4383795274676206e-18,5.542899068575326e-18,-1.4322193309902883e-17,7.798578672604598e-18,0.0,-7.844637614262704e-18,-5.07281565665175e-18,6.564393203922159e-18,0.0,-1.2774796927758549e-17,-2.0921897189160746e-18,6.786322601617023e-18,1.0737872570026723e-17,-7.771133261927911e-18,-5.368241361839619e-18,7.140755797288416e-18,3.85045101728622e-18,-7.710248179305728e-18,-5.448312572723135e-18,-3.1162284852173363e-17,1.6832248040587957e-17,-2.4173835713647138e-17,0.0,8.889411019355629e-18,0.0,0.0,-1.895183254097871e-17,-1.136553919241403e-17,0.0,0.0,-1.6564482275033915e-17,1.5085180821594415e-17,-1.0624064032021229e-17,2.606375484292059e-17,0.0,0.0,1.2919962122900454e-18,-2.2545974210790763e-18,-6.3299074929477675e-18,-4.6036999745667735e-18,0.0,0.0,0.0,-1.9741570266700143e-17,0.0,0.0,1.6281666426932954e-18,0.0,0.0,0.0,0.0,-2.9761400112373097e-18,-7.575594488549455e-18,1.629060914554054e-17,3.59634231817626e-18,0.0,0.0,0.0,0.0,2.1966336900748824e-18,5.596922670151051e-18,2.171356969150716e-18,2.0327986327850397e-17,2.3995394169039285e-18,-4.121782279191388e-18,3.531327620483024e-18,1.0613865934928805e-17,0.0,0.0,1.933170719939735e-18,2.4910712561151445e-18,5.921902429079019e-18,-1.0949309021355422e-17,-2.273918989515454e-17,0.0,6.931184888249595e-18,-7.526250332049694e-18,-1.6246661512084555e-17,9.642779906920363e-18,0.0,5.36423057085564e-18,0.0,0.0,0.0,0.0,-1.7898715598438977e-18,6.562222706278808e-18,-3.175429984651436e-18,0.0
#     ]
# }

if __name__ == '__main__':
    run(host='localhost', port=8080)